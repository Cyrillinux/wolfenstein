var App=App||{};App.maps=App.maps||{},App.Properties={container:"stage",selectorEngine:function(){return{byId:function(e){return document.getElementById(e)},createTag:function(e){return document.createElement(e)},getByTag:function(e){return document.getElementsByTagName(e)[0]}}}(),templateEngine:App.template,texturesPath:"src/resources/textures/",spritesPath:"src/resources/sprites/",statusbarPath:"src/resources/statusbar/",soundPath:"src/resources/sounds/",fps:30,playerSpeed:.18,playerRotateSpeed:3,raycastingColor:"rgba(0,100,0,0.3)",screenWidth:720,screenHeight:480,stripWidth:2,miniMapElementId:"minimap",miniMapObjectElementId:"minimapobjects",miniMapScale:4,miniMapBlocksColor:"#000",miniMapDebugMode:!1},App.Helpful={isNull:function(e){return void 0===e||null===e},isNumber:function(e){return"number"==typeof e},hasOnlyNumbers:function(e){for(var t=!0,i=0;i<e.length;i++)if(!App.Helpful.isNumber(e[i])){t=!1;break}return t},isArray:function(e){return e instanceof Array},mergeObjects:function(e,t){for(var i in e)e[i]&&e[i].constructor&&e[i].constructor===Object?(t[i]=t[i]||{},arguments.callee(e[i],t[i])):t[i]=e[i];return t},isNodeWebkit:function(){return"object"==typeof process}},App.define=App.define||function(e,t,i){function s(e){var t={},s=e[0];e.reverse();for(var n=0;e.length>n;n++){var r={};if(0===n){var o={};switch(s){case"views":o=i(function(){},App.Properties.selectorEngine,App.Properties.templateEngine);break;default:o=i(function(){})}r[e[n]]=o}else r[e[n]]=t;t=r}return t}function n(e,t){return App.Helpful.mergeObjects(e,t)}var r=t.split("/");r.push(e);var o=s(r);App=n(o,App)},App.define("Shortcut","core/config",function(e){"use strict";function t(){var e=0,t=i.length;for(e;t>e;e++){var s=i[e];App[s.key]=s.value}}var i=[{key:"container",value:App.Properties.container}];return e=function(){t()},e.prototype.addShortcut=function(e,t){App[e]=t},e}),new App.core.config.Shortcut,App.Exception={"throw":function(e,t){var i="::Exception::";App.Helpful.isNull(e)||App.Helpful.isNull(t)?console.error(i+"\n	 Message: "+e):console.error(i+"\n	 Message: "+e+"\n	 Cause: ",t)}},App.define("Collision","engine",function(e){"use strict";function t(e,t,i,s){if(0>t||t>=i.mapHeight||0>e||e>=i.mapWidth)return!0;var n=Math.floor(e),r=Math.floor(t);return 0!==i.level.map[r][n]?!0:s.sprites.spriteMap[r][n]&&s.sprites.spriteMap[r][n].block?!0:!1}return e.prototype.checkCollision=function(e,i,s,n,r,o,a){var p={x:e,y:i};if(0>n||n>=o.mapHeight||0>s||s>=o.mapWidth)return p;var l=Math.floor(s),c=Math.floor(n);if(t(l,c,o,a))return p;p.x=s,p.y=n;var h=t(l,c-1,o,a),u=t(l,c+1,o,a),d=t(l-1,c,o,a),f=t(l+1,c,o,a);h&&r>n-c&&(n=p.y=c+r),u&&r>c+1-n&&(n=p.y=c+1-r),d&&r>s-l&&(s=p.x=l+r),f&&r>l+1-s&&(s=p.x=l+1-r);var y=0,g=0;return 0===t(l-1,c-1,o,a)||0!==h&&0!==d||(y=s-l,g=n-c,r*r>y*y+g*g&&(y*y>g*g?s=p.x=l+r:n=p.y=c+r)),0===t(l+1,c-1,o,a)||0!==h&&0!==f||(y=s-(l+1),g=n-c,r*r>y*y+g*g&&(y*y>g*g?s=p.x=l+1-r:n=p.y=c+r)),0===t(l-1,c+1,o,a)||0!==u&&0!==u||(y=s-l,g=n-(c+1),r*r>y*y+g*g&&(y*y>g*g?s=p.x=l+r:n=p.y=c+1-r)),0===t(l+1,c+1,o,a)||0!==u&&0!==f||(y=s-(l+1),g=n-(c+1),r*r>y*y+g*g&&(y*y>g*g?s=p.x=l+1-r:n=p.y=c+1-r)),p},e}),App.define("Controls","engine",function(e){"use strict";var t=!1,i=!1;return e=function(){console.log("[Controls] Configured"),this.forwardKey=[38,87],this.backwardKey=[40,83],this.rightKey=[39,68],this.leftKey=[37,65],this.enableMap=77,this.enableFPSDisplay=70,this.shoot=[0,32]},e.prototype.keyboardMap=function(e){var s,n=this,r=App.Properties.selectorEngine,o=r.byId("minimap-container"),a=r.byId("fps-debug");try{s=new Event("shoot")}catch(p){s=document.createEvent("CustomEvent"),s.initCustomEvent("shoot",!1,!1,null)}document.onkeydown=function(r){switch(r=r||window.event,r.keyCode){case n.forwardKey[0]:case n.forwardKey[1]:e.speed=1;break;case n.backwardKey[0]:case n.backwardKey[1]:e.speed=-1;break;case n.leftKey[0]:case n.leftKey[1]:e.dir=-1;break;case n.rightKey[0]:case n.rightKey[1]:e.dir=1;break;case n.enableMap:t?(t=!1,o.style.display="none"):(t=!0,o.style.display="block");break;case n.enableFPSDisplay:i?(i=!1,a.style.display="none"):(i=!0,a.style.display="block");break;case n.shoot[0]:case n.shoot[1]:document.dispatchEvent(s)}},document.onkeyup=function(t){switch(t=t||window.event,t.keyCode){case n.forwardKey[0]:case n.forwardKey[1]:case n.backwardKey[0]:case n.backwardKey[1]:e.speed=0;break;case n.leftKey[0]:case n.leftKey[1]:case n.rightKey[0]:case n.rightKey[1]:e.dir=0}}},e}),App.define("Enemies","engine",function(e){"use strict";var t="guard";return e=function(e){console.log("[Enemies] Add enemies"),this.$selector=e,this.enemiesList=[],this.entity=new App.engine.Entity},e.prototype.init=function(e){this.enemiesAmount=e.length;var i=0,s=this.$selector.byId("screen");for(i;this.enemiesAmount>i;i++){var n=e[i];if(n.type===t){var r=new App.engine.enemies.Guard(n,this.$selector);this.enemiesList.push(r),s.appendChild(r.img)}}},e.prototype.render=function(e,t,i){var s=0;for(s;s<this.enemiesAmount;s++){var n=this.enemiesList[s],r=n.img,o=n.x-e.x,a=n.y-e.y,p=Math.atan2(a,o)-e.rot;p<-Math.PI&&(p+=2*Math.PI),p>=Math.PI&&(p-=2*Math.PI);var l=0,c=0,h=0,u=Math.tan(p)*t,d=null,f=null,y=null,g=null,m=null,v=0,b="none",M=null;if(p>.5*-Math.PI&&p<.5*Math.PI){if(l=o*o+a*a,c=Math.sqrt(l),h=t/(Math.cos(p)*c),0>=h)continue;u=Math.tan(p)*t,d=r.style,f=n.oldStyles,h!==f.height&&(d.height=h+"px",f.height=h),y=h*n.totalStates,y!==f.width&&(d.width=y+"px",f.width=y),g=(i.screenHeight-h)/2,g!=f.top&&(d.top=g+"px",f.top=g),m=i.screenWidth/2+u-h/2-h*n.state,m!==f.left&&(d.left=m+"px",f.left=m),v=-(1e3*l)>>0,v!==f.zIndex&&(d.zIndex=v,f.zIndex=v),b="block",b!==f.display&&(d.display=b,f.display=b),M="rect(0px, "+h*(n.state+1)+"px, "+h+"px, "+h*n.state+"px)",M!==f.clip&&(d.clip=M,f.clip=M)}else b="none",b!==n.oldStyles.display&&(r.style.display=b,n.oldStyles.display=b)}},e.prototype.ai=function(e,t,i,s,n){var r=0;for(r;r<this.enemiesAmount;r++){var o=this.enemiesList[r],a=t.x-o.x,p=t.y-o.y,l=Math.sqrt(a*a+p*p);if(l>4){var c=Math.atan2(p,a);o.rotDeg=180*c/Math.PI,o.rot=c,o.speed=1,o.state=Math.floor(new Date%o.walkCycleTime/(o.walkCycleTime/o.numWalkSprites))+1}else o.state=0,o.speed=0;this.entity.move(o,e,i,s,n)}},e}),App.define("Entity","engine",function(e){"use strict";return e=function(){this.collision=new App.engine.Collision},e.prototype.move=function(e,t,i,s,n){var r=t/n,o=r*e.speed*e.moveSpeed;e.rotDeg+=r*e.dir*e.rotSpeed,e.rotDeg%=360,e.rotDeg<-180&&(e.rotDeg+=360),e.rotDeg>=180&&(e.rotDeg-=360);var a=(e.rotDeg+360)%90;(2>a||a>88)&&(e.rotDeg=90*Math.round(e.rotDeg/90)),e.rot=e.rotDeg*Math.PI/180;var p=e.x+Math.cos(e.rot)*o,l=e.y+Math.sin(e.rot)*o,c=this.collision.checkCollision(e.x,e.y,p,l,.35,i,s);e.x=c.x,e.y=c.y},e}),App.define("FaceReaction","engine",function(e){"use strict";function t(e){for(var t=r*o.length,s=0;100>s;s++)i(e,t*s)}function i(e,t){var i=o.length;setTimeout(function(){for(var t=0;i>t;t++)s(e,o[t],r*t)},t)}function s(e,t,i){setTimeout(function(){e.reactions.className=t},i)}function n(e){var t=e.createTag("div");return t.id="reactions",t.className="face01",t}var r=(App.Properties.statusbarPath,500),o=["face01","face02","face03","face02","face01","face01","face01","face02","face02","face03","face03","face01","face03","face01","face02","face03","face02"];return e=function(e){console.log("[FaceReaction] Creating the face reaction"),this.$=e,this.reactions=n(this.$),t(this)},e.prototype.faces=function(){return this.reactions},e}),App.define("FPSDebug","engine",function(e){"use strict";return e=function(){console.log("[FPS debug] Enabled");var e=App.Properties.selectorEngine;this.overlay=e.byId("fps-debug")},e.prototype.update=function(e){this.overlay.innerHTML="FPS: "+e.toFixed(1)+"<br/>"+this.overlayText,this.overlayText=""},e}),App.define("GameCycle","engine",function(e){"use strict";var t=App.Properties.fps,i=1e3/t,s=0,n=0;return e=function(){console.log("[GameCycle] Creating the Game Cycle")},e.prototype.setElements=function(e,t,i,s,n,r){this.player=e,this.miniMap=t,this.raycasting=s,this.screen=i,this.statusBar=n,this.fpsDebug=new App.engine.FPSDebug,this.levelSound=r,this.levelSound.play()},e.prototype.init=function(){var e=(new Date).getTime(),t=e-s;this.player.move(this.miniMap,this.screen,t,i),this.screen.enemies.ai(t,this.player,this.miniMap,this.screen,i),this.statusBar.update();var n=i;t>n&&(n=Math.max(1,n-(t-n)));var r=this;setTimeout(function(){r.init()},n),s=e},e.prototype.renderCycle=function(){this.miniMap.update(this.player),this.screen.sprites.clearObjects(),this.raycasting.castRays(),this.screen.sprites.renderObjects(this.player,this.raycasting.viewDist,this.screen.screenWidth,this.screen.screenHeight),this.screen.enemies.render(this.player,this.raycasting.viewDist,this.screen);var e=(new Date).getTime(),t=e-n,s=i;t>s&&(s=Math.max(1,s-(t-s))),n=e;var r=this;setTimeout(function(){r.renderCycle()},s),this.fpsDebug.update(1e3/t)},e}),App.define("MiniMap","engine",function(e){"use strict";function t(e,t){var s=t.byId(n),c=t.byId(r);s.width=a*o,s.height=p*o,c.width=s.width,c.height=s.height;var h=a*o+"px",u=p*o+"px";s.style.width=c.style.width=h,s.style.height=c.style.height=u;for(var d=s.getContext("2d"),f=0;p>f;f++)for(var y=0;a>y;y++){var g=e.map[f][y];g>0&&(d.fillStyle=l,i(d,y,f))}}function i(e,t,i){if(c){var n=25,r=h*n;h++,setTimeout(function(){s(e,t,i)},r)}else s(e,t,i)}function s(e,t,i){e.fillRect(t*o,i*o,o,o)}var n=App.Properties.miniMapElementId,r=App.Properties.miniMapObjectElementId,o=App.Properties.miniMapScale,a=0,p=0,l=App.Properties.miniMapBlocksColor,c=App.Properties.miniMapDebugMode,h=1;return e=function(e,t){console.log("[MiniMap] Creating the mini map"),this.level=e,this.$selector=t},e.prototype.init=function(){a=this.level.map[0].length,p=this.level.map.length,this.mapWidth=a,this.mapHeight=p,this.miniMapScale=o,t(this.level,this.$selector)},e.prototype.update=function(e){var t=this.$selector.byId(n);this.miniMapObjects=this.$selector.byId(r);var i=this.miniMapObjects.getContext("2d");i.clearRect(0,0,t.width,t.height),i.fillRect(e.x*this.miniMapScale-2,e.y*this.miniMapScale-2,4,4),i.beginPath(),i.moveTo(e.x*this.miniMapScale,e.y*this.miniMapScale),i.lineTo((e.x+4*Math.cos(e.rot))*this.miniMapScale,(e.y+4*Math.sin(e.rot))*this.miniMapScale),i.closePath(),i.stroke()},e}),App.define("Player","engine",function(e){"use strict";return e=function(e,t){console.log("[Player] Creating a Player"),this.x=e,this.y=t,this.dir=0,this.rot=0,this.rotDeg=0,this.speed=0,this.moveSpeed=App.Properties.playerSpeed,this.rotSpeed=App.Properties.playerRotateSpeed,this.setControls(),this.entity=new App.engine.Entity},e.prototype.move=function(e,t,i,s){this.entity.move(this,i,e,t,s)},e.prototype.setControls=function(){var e=new App.engine.Controls;e.keyboardMap(this)},e}),App.define("Raycasting","engine",function(e){"use strict";function t(e,t,n,o,a,p){a=t.rot+a,a%=r,0>a&&(a+=r);for(var l,c,h,u=a>.75*r||.25*r>a,d=0>a||a>Math.PI,f=0,y=Math.sin(a),g=Math.cos(a),m=0,v=0,b=0,M=0,A=0,S=!1,w=!1,x=y/g,P=u?1:-1,k=P*x,C=u?Math.ceil(t.x):Math.floor(t.x),I=t.y+(C-t.x)*x,T=0,E=0;C>=0&&C<n.mapWidth&&I>=0&&I<n.mapHeight;){if(c=Math.floor(C+(u?0:-1)),h=Math.floor(I),e.sprites.spriteMap[h][c]&&!e.sprites.spriteMap[h][c].visible&&(e.sprites.spriteMap[h][c].visible=!0,e.sprites.visibleSprites.push(e.sprites.spriteMap[h][c])),n.level.map[h][c]>0){T=C-t.x,E=I-t.y,m=T*T+E*E,f=n.level.map[h][c],l=I%1,u||(l=1-l),v=C,b=I,M=c,A=h,S=!0,w=!0;break}C+=P,I+=k}x=g/y;var W=d?-1:1,D=W*x;for(I=d?Math.floor(t.y):Math.ceil(t.y),C=t.x+(I-t.y)*x;C>=0&&C<n.mapWidth&&I>=0&&I<n.mapHeight;){if(h=Math.floor(I+(d?-1:0)),c=Math.floor(C),e.sprites.spriteMap[h][c]&&!e.sprites.spriteMap[h][c].visible&&(e.sprites.spriteMap[h][c].visible=!0,e.sprites.visibleSprites.push(e.sprites.spriteMap[h][c])),n.level.map[h][c]>0){T=C-t.x,E=I-t.y;var $=T*T+E*E;(!m||m>$)&&(m=$,v=C,b=I,M=c,A=h,f=n.level.map[h][c],l=C%1,d&&(l=1-l),S=!1);break}C+=D,I+=W}m&&(i(v,b,n,t),s(e,p,m,t,o,a,f,l,n.level,S,M,A))}function i(e,t,i,s){var n=i.miniMapObjects.getContext("2d");n.strokeStyle=App.Properties.raycastingColor,n.lineWidth=.5,n.beginPath(),n.moveTo(s.x*i.miniMapScale,s.y*i.miniMapScale),n.lineTo(e*i.miniMapScale,t*i.miniMapScale),n.closePath(),n.stroke()}function s(e,t,i,s,n,r,o,a,p,l,c,h){var u=e.screenStrips[t];i=Math.sqrt(i),i*=Math.cos(s.rot-r);for(var d,f=Math.round(n/i),y=f*e.stripWidth,g=Math.round((e.screenHeight-f)/2),m=0,v=p.mapTextures,b=App.Properties.texturesPath,M=v.length,A=0;M>A;A++){var S=v[A];if(S.id===o&&S.texture){b+=S.texture;break}}u.src=b,u.oldStyles.src=b,d=f,u.oldStyles.height!==d&&(u.style.height=d+"px",u.oldStyles.height=d);var w=Math.round(a*y);w>y-e.stripWidth&&(w=y-e.stripWidth),w+=l?y:0;var x=Math.floor(2*y);u.oldStyles.width!==x&&(u.style.width=x+"px",u.oldStyles.width=x);var P=g-m;u.oldStyles.top!==P&&(u.style.top=P+"px",u.oldStyles.top=P);var k=t*e.stripWidth-w;u.oldStyles.left!==k&&(u.style.left=k+"px",u.oldStyles.left=k);var C="rect("+m+"px, "+(w+e.stripWidth)+"px, "+(m+f)+"px, "+w+"px)";u.oldStyles.clip!==C&&(u.style.clip=C,u.oldStyles.clip=C);var I=c-s.x,T=h-s.y,E=I*I+T*T;u.style.zIndex=-Math.floor(1e3*E)}var n=60*Math.PI/180,r=2*Math.PI;return e=function(e,t,i){this.player=e,this.miniMap=t,this.screen=i,this.numRays=Math.ceil(this.screen.screenWidth/this.screen.stripWidth),this.viewDist=this.screen.screenWidth/2/Math.tan(n/2)},e.prototype.castRays=function(){for(var e=0,i=0;i<this.numRays;i++){var s=(-this.numRays/2+i)*this.screen.stripWidth,n=Math.sqrt(s*s+this.viewDist*this.viewDist),r=Math.asin(s/n);t(this.screen,this.player,this.miniMap,this.viewDist,r,e++)}},e}),App.define("Screen","engine",function(e){"use strict";return e=function(e){console.log("[Screen] Creating the screen"),this.$selector=e,this.screenWidth=App.Properties.screenWidth,this.screenHeight=App.Properties.screenHeight,this.screenStrips=[],this.stripWidth=App.Properties.stripWidth},e.prototype.init=function(){for(var e=this.$selector.byId("screen"),t=0;t<this.screenWidth;t+=this.stripWidth){var i=this.$selector.createTag("img");i.style.position="absolute",i.style.left="0px",i.style.height="0px",i.oldStyles={left:0,top:0,width:0,height:0,clip:"",src:""},this.screenStrips.push(i),e.appendChild(i)}},e.prototype.addSprites=function(e){this.sprites=e},e.prototype.addEnemies=function(e){this.enemies=e},e}),App.define("Sound","engine",function(e){"use strict";var t="sounds";return e=function(e){return this.$=e,this},e.prototype.init=function(e,i,s,n){this.audio=this.$.createTag("audio"),this.audio.setAttribute("id",e),this.audio.autoplay=s,this.audio.loop=n;var r=this.$.createTag("source");r.setAttribute("src",i+".wav"),r.setAttribute("type","audio/wav"),this.audio.appendChild(r);var o=this.$.byId(t);o.appendChild(this.audio)},e.prototype.play=function(){this.audio.play()},e.prototype.pause=function(){this.audio.pause()},e.prototype.reset=function(){this.audio.currentTime=0},e}),App.define("Sprites","engine",function(e){"use strict";return e=function(e){console.log("[Sprite] Adding sprites in the game"),this.$selector=e,this.spriteMap=[],this.visibleSprites=[],this.oldVisibleSprites=[]},e.prototype.init=function(e,t){for(var i=e.length,s=0;i>s;s++)this.spriteMap[s]=[];for(var n=this.$selector.byId("screen"),r=t.length,o=0;r>o;o++){var a=t[o],p=this.$selector.createTag("img");p.src=App.Properties.spritesPath+a.img,p.style.display="none",p.style.position="absolute",a.visible=!1,a.block=a.block,a.img=p,this.spriteMap[a.positionY][a.positionX]=a,n.appendChild(p)}},e.prototype.clearObjects=function(){this.oldVisibleSprites=[];for(var e=0;e<this.visibleSprites.length;e++){var t=this.visibleSprites[e];this.oldVisibleSprites[e]=t,t.visible=!1}this.visibleSprites=[]},e.prototype.renderObjects=function(e,t,i,s){for(var n="",r=0;r<this.visibleSprites.length;r++){n=this.visibleSprites[r];var o=n.img;o.style.display="block";var a=n.positionX+.5-e.x,p=n.positionY+.5-e.y,l=Math.sqrt(a*a+p*p),c=Math.atan2(p,a)-e.rot,h=t/(Math.cos(c)*l);if(!(0>=h)){var u=Math.tan(c)*t;o.style.left=i/2+u-h/2+"px",o.style.top=(s-h)/2+"px";var d=n.positionX-e.x,f=n.positionY-e.y;o.style.width=h+"px",o.style.height=h+"px";var y=d*d+f*f;o.style.zIndex=-Math.floor(1e3*y)}}for(r=0;r<this.oldVisibleSprites.length;r++)n=this.oldVisibleSprites[r],this.visibleSprites.indexOf(n)<0&&(n.visible=!1,n.img.style.display="none")},e}),App.define("StatusBar","engine",function(e){"use strict";function t(e){var t=e.createTag("img");return t.src=s+i,t.id="status-bar",t}var i="statusbar.jpg",s=App.Properties.statusbarPath;return e=function(e){console.log("[StatusBar] Creating the status bar"),this.$selector=e,this.weapon=new App.engine.Weapon(e),this.reactions=new App.engine.FaceReaction(e),this.init()},e.prototype.init=function(){var e=this.$selector.byId("screen"),i=t(this.$selector);e.appendChild(this.weapon["default"]()),e.appendChild(i),e.appendChild(this.reactions.faces())},e.prototype.update=function(){},e}),App.define("Weapon","engine",function(e){"use strict";var t;return e=function(e){console.log("[Weapon] Creating the weapon"),t=App.engine.weapons.Pistol,this.$=e,this.listeningShootEvent()},e.prototype.current=function(){return this.current},e.prototype["default"]=function(){var e=new t(this.$);return e.init(),this.current=e,e.img},e.prototype.listeningShootEvent=function(){var e=this;document.addEventListener("shoot",function(t){e.current.shoot()},!1)},e}),App.define("Guard","engine/enemies",function(e){"use strict";function t(){return{left:0,top:0,width:0,height:0,clip:"",display:"none",zIndex:0}}var i="guard-walk.png",s=App.Properties.spritesPath+"guard/";return e=function(e,n){console.log("[Guard] Add guard"),this.cssRoot="guard",this.x=e.positionX,this.y=e.positionY,this.state=0,this.rot=0,this.rotDeg=0,this.dir=0,this.speed=0,this.moveSpeed=.05,this.rotSpeed=3,this.totalStates=5,this.walkCycleTime=1e3,this.numWalkSprites=4;var r=n.createTag("img");return r.src=s+i,r.style.display="none",r.style.position="absolute",r.classList.add(this.cssRoot),this.oldStyles=t(),this.img=r,this}}),App.define("Pistol","engine/weapons",function(e){"use strict";function t(e){for(var t=e.length,i=0;t>i;i++){var s=new Image;s.src=n+e[i]}}function i(e,t,i,s){setTimeout(function(){t.src=n+i,2==a&&(e.soundPistolShooting.reset(),e.soundPistolShooting.play()),a>0&&a--},s)}function s(e){var t=e.$.createTag("img");t.src=n+"pistol_0.png",t.id="weapon",t.className="pistol",e.img=t}var n=App.Properties.statusbarPath+"pistol/",r=App.Properties.soundPath+"weapons/",o=50,a=0;return e=function(e){this.$=e},e.prototype.init=function(){this.soundPistolShooting=new App.engine.Sound(this.$),this.soundPistolShooting.init("pistol",r+"pistol",!1,!1),this.frames=["pistol_0.png","pistol_4.png","pistol_1.png","pistol_2.png","pistol_3.png","pistol_1.png","pistol_4.png","pistol_0.png"],t(this.frames),s(this)},e.prototype.shoot=function(){if(0===a){var e=this,t=e.frames.length;a=t;for(var s=0;t>s;s++)i(e,e.img,e.frames[s],o*s)}},e}),App.maps.firstLevel={playerX:10.5,playerY:6.5,map:[[1,1,1,1,1,1,1,1,5,5,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,3,0,3,0,0,1,1,1,2,1,1,1,1,1,2,1,1,1,2,1,0,0,0,0,0,0,0,0,1],[1,0,0,3,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,1,1,1,1,1],[1,0,0,3,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,3,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],[1,0,0,3,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,3,3,3,0,0,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2],[1,0,0,0,0,0,0,0,0,3,3,3,0,0,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,3,3,3,0,0,3,3,3,0,0,0,0,0,0,0,0,0,3,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,3,3,3,0,0,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,4,0,0,4,2,0,2,2,2,2,2,2,2,2,0,2,4,4,0,0,4,0,0,0,0,0,0,0,1],[1,0,0,4,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,4,0,0,0,0,0,0,0,1],[1,0,0,4,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,4,0,0,0,0,0,0,0,1],[1,0,0,4,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,4,0,0,0,0,0,0,0,1],[1,0,0,4,3,3,4,2,2,2,2,2,2,2,2,2,2,2,2,2,4,3,3,4,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],mapTextures:[{id:1,texture:"walls_1.png"},{id:2,texture:"walls_2.png"},{id:3,texture:"walls_3.png"},{id:4,texture:"walls_4.png"},{id:5,texture:"walls_5.png"}],objects:[{img:"lamp.png",positionX:10,positionY:7,block:!1},{img:"lamp.png",positionX:15,positionY:7,block:!1},{img:"tablechairs.png",positionX:10,positionY:18,block:!0},{img:"tablechairs.png",positionX:15,positionY:18,block:!0},{img:"plantgreen.png",positionX:10,positionY:11,block:!0},{img:"plantgreen.png",positionX:15,positionY:11,block:!0}],enemies:[{type:"guard",positionX:20,positionY:9},{type:"guard",positionX:18,positionY:6}],backgroundSound:{id:"sound-level-01",track:"level_01",type:"wav"}},App.define("Stage","views/stage",function(e,t,i){"use strict";function s(e){e.innerHTML+=i.screen(),e.innerHTML+=i.mini_map(),e.innerHTML+=i.fps_debug()}function n(){var e=App.maps.firstLevel,i=new r(e,t);i.init();var s=new o(t);s.init();var n=new c(t);n.init(e.map,e.objects);var y=new h(t);y.init(e.enemies),s.addSprites(n),s.addEnemies(y);var g=new a,m=new p(e.playerX,e.playerY),v=new l(m,i,s),b=new u(t),M=e.backgroundSound,A=new d(t);A.init(M.id,f+M.track,!0,!0),g.setElements(m,i,s,v,b,A),g.init(),g.renderCycle()}var r=App.engine.MiniMap,o=App.engine.Screen,a=App.engine.GameCycle,p=App.engine.Player,l=App.engine.Raycasting,c=App.engine.Sprites,h=App.engine.Enemies,u=App.engine.StatusBar,d=App.engine.Sound,f=App.Properties.soundPath+"levels/";return e.prototype.init=function(){var e;App.Helpful.isNodeWebkit()||(e=t.getByTag("body"),e.className="in-browser");var i=t.byId(App.container);s(i),n()},e}),document.addEventListener("DOMContentLoaded",function(e){var t=new App.views.stage.Stage;t.init()});